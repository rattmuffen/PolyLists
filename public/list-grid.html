<!DOCTYPE html>
<link rel="import" href="bower_components/iron-ajax/iron-ajax.html">

<link rel="import" href="grid-item.html">

<dom-module id="list-grid">
	<style>
		#listgrid {
			-webkit-columns: 300px 3;
			-moz-columns: 300px 3;
			columns: 300px 3;
		}
	</style>

    <template>
		<!-- Auto fetch lists from server -->
		<iron-ajax auto url="get/lists" handle-as="json" on-response="response"></iron-ajax>

		<div id="listgrid">
			<template is="dom-repeat" items="[[data]]">
				<grid-item
						   listid="{{item.id}}"
						   title="{{item.title}}"
						   image="{{item.image}}"
						   items="{{item.items}}"
						   checkable="{{item.checkable}}"
						   color="{{item.color}}"
						   description="{{item.description}}">
				</grid-item> 
			</template>
		</div>
    </template>
	
	<script>
		Polymer({
			is: "list-grid",
			ready: function () {
				this.data = [];
			},
			response: function(request) {
				this.data =  request.detail.response;
				console.log(this.data)
			},
			update: function(data) {
				this.data = JSON.parse(data);
			}
		});
		
		var socket = io();
		socket.on('update-data', function(data) {
			console.log('Recieved data update.');
			$('#list-grid')[0].update(data);
		});
	</script>
</dom-module>